Python 3.7.4 (default, Aug  9 2019, 18:34:13) [MSC v.1915 64 bit (AMD64)]
Type 'copyright', 'credits' or 'license' for more information
IPython 7.9.0 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.9.0

Python 3.7.4 (default, Aug  9 2019, 18:34:13) [MSC v.1915 64 bit (AMD64)] on win32
Out[2]: torch.Size([51, 8])
Exception in thread Thread-14:
Traceback (most recent call last):
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\threading.py", line 926, in _bootstrap_inner
    self.run()
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\runners\RunnerBase.py", line 22, in run_n_episodes
    trajectory = self.run_1_episode()
  File "C:\Users\joon0\dev\hierarchical_qmix\src\runners\MultiStepActorRunner.py", line 37, in run_1_episode
    tag2unit_dict=tag2unit_dict)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\agent\QmixAgent.py", line 81, in get_action
    maximum_num_enemy=maximum_num_enemy)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\brain\QmixBrain.py", line 86, in get_action
    nn_actions, info_dict = qnet.get_action(**inputs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\rl\MultiStepQnet.py", line 64, in get_action
    curr_graph, curr_feature, maximum_num_enemy)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\rl\MultiStepQnet.py", line 48, in compute_qs
    curr_feature)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\torch\nn\modules\module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\MultiStepInputGraphNetwork.py", line 61, in forward
    h_enc_out, h_enc_hidden = self.hist_encoder(num_time_steps, hist_graph, hist_feature)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\torch\nn\modules\module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\RNNEncoder.py", line 31, in forward
    embedded_feature_dict = self.one_step_encoder(batch_time_batched_graph, node_feat)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\torch\nn\modules\module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\RelationalGraphNetwork.py", line 66, in forward
    node_feature = layer(graph, node_feature)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\torch\nn\modules\module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\RelationalGraphLayer.py", line 99, in forward
    reduce_func=self.reduce_function)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\dgl\graph.py", line 2502, in send_and_recv
    Runtime.run(prog)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\dgl\runtime\runtime.py", line 11, in run
    exe.run()
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\dgl\runtime\ir\executor.py", line 132, in run
    udf_ret = fn_data(node_data, mail_data)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\dgl\runtime\degree_bucketing.py", line 153, in _rfunc_wrapper
    return reduce_udf(nbatch)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\RelationalGraphLayer.py", line 146, in reduce_function
    node_enc_input[:, :self.input_dim + self.init_dim] = F.relu(node_feature)
RuntimeError: The expanded size of the tensor (16) must match the existing size (27) at non-singleton dimension 1.  Target sizes: [24, 16].  Tensor sizes: [24, 27]

Traceback (most recent call last):
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\pydevd.py", line 2073, in <module>
    main()
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\pydevd.py", line 2067, in main
    globals = debugger.run(setup['file'], None, None, is_module)
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\pydevd.py", line 1418, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\pydevd.py", line 1425, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\_pydev_imps\_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "C:/Users/joon0/dev/hierarchical_qmix/src/test/test.py", line 34, in <module>
    fit_return_dict = agent.fit(device='cuda')
  File "C:\Users\joon0\dev\hierarchical_qmix\src\agent\QmixAgent.py", line 124, in fit
    c_h_graph, c_graph, actions, rewards, n_h_graph, n_graph, dones = self.buffer.sample(batch_size)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\memory\MemoryBase.py", line 55, in sample
    effective_num_samples = np.cumsum(num_samples_par_trajs)[-1]
IndexError: index -1 is out of bounds for axis 0 with size 0
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\IPython\core\history.py", line 780, in writeout_cache
    self._writeout_input_cache(conn)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\IPython\core\history.py", line 764, in _writeout_input_cache
    (self.session_number,)+line)
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 20948 and this is thread id 9992.
[0m