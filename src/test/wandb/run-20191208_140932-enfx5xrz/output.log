{'loss': array(186.11583, dtype=float32), 'loss2': array(329.97104, dtype=float32), 'loss_tot': array(516.08685, dtype=float32), 'train_winning_ratio': 0.0, 'epsilon': tensor([0.4975])}
{'loss': array(43.84995, dtype=float32), 'loss2': array(54.26528, dtype=float32), 'loss_tot': array(98.115234, dtype=float32), 'train_winning_ratio': 0.08100000000000002, 'epsilon': tensor([0.4950])}
{'loss': array(9.425026, dtype=float32), 'loss2': array(20.763699, dtype=float32), 'loss_tot': array(30.188725, dtype=float32), 'train_winning_ratio': 0.043046721000000024, 'epsilon': tensor([0.4925])}
{'loss': array(4.2130466, dtype=float32), 'loss2': array(9.232133, dtype=float32), 'loss_tot': array(13.445179, dtype=float32), 'train_winning_ratio': 0.12287679245496103, 'epsilon': tensor([0.4901])}
{'loss': array(10.24146, dtype=float32), 'loss2': array(3.2883933, dtype=float32), 'loss_tot': array(13.529853, dtype=float32), 'train_winning_ratio': 0.16530176545905695, 'epsilon': tensor([0.4876])}
{'loss': array(7.405815, dtype=float32), 'loss2': array(2.8567913, dtype=float32), 'loss_tot': array(10.262607, dtype=float32), 'train_winning_ratio': 0.1778481355373267, 'epsilon': tensor([0.4852])}
{'loss': array(6.323739, dtype=float32), 'loss2': array(6.9379625, dtype=float32), 'loss_tot': array(13.261702, dtype=float32), 'train_winning_ratio': 0.18451579099809248, 'epsilon': tensor([0.4828])}
{'loss': array(6.1478825, dtype=float32), 'loss2': array(7.365733, dtype=float32), 'loss_tot': array(13.513616, dtype=float32), 'train_winning_ratio': 0.09805925648381726, 'epsilon': tensor([0.4803])}
{'loss': array(7.1544724, dtype=float32), 'loss2': array(6.07503, dtype=float32), 'loss_tot': array(13.229502, dtype=float32), 'train_winning_ratio': 0.13311270932501634, 'epsilon': tensor([0.4779])}
{'loss': array(6.4024415, dtype=float32), 'loss2': array(5.117259, dtype=float32), 'loss_tot': array(11.519701, dtype=float32), 'train_winning_ratio': 0.26074155135639604, 'epsilon': tensor([0.4756])}
{'loss': array(9.757545, dtype=float32), 'loss2': array(13.786411, dtype=float32), 'loss_tot': array(23.543957, dtype=float32), 'train_winning_ratio': 0.21956875079439456, 'epsilon': tensor([0.4732])}
{'loss': array(9.765521, dtype=float32), 'loss2': array(10.647493, dtype=float32), 'loss_tot': array(20.413013, dtype=float32), 'train_winning_ratio': 0.11668783649092386, 'epsilon': tensor([0.4708])}
{'loss': array(9.240917, dtype=float32), 'loss2': array(9.429471, dtype=float32), 'loss_tot': array(18.670387, dtype=float32), 'train_winning_ratio': 0.1276227005125731, 'epsilon': tensor([0.4685])}
{'loss': array(10.683099, dtype=float32), 'loss2': array(15.677187, dtype=float32), 'loss_tot': array(26.360287, dtype=float32), 'train_winning_ratio': 0.06782393558310237, 'epsilon': tensor([0.4661])}
{'loss': array(10.374279, dtype=float32), 'loss2': array(7.206627, dtype=float32), 'loss_tot': array(17.580906, dtype=float32), 'train_winning_ratio': 0.03604442015021951, 'epsilon': tensor([0.4638])}
{'loss': array(7.3754396, dtype=float32), 'loss2': array(8.762341, dtype=float32), 'loss_tot': array(16.13778, dtype=float32), 'train_winning_ratio': 0.20915548268905282, 'epsilon': tensor([0.4615])}
{'loss': array(5.6986694, dtype=float32), 'loss2': array(5.227582, dtype=float32), 'loss_tot': array(10.926251, dtype=float32), 'train_winning_ratio': 0.11115379887575294, 'epsilon': tensor([0.4592])}
{'loss': array(8.915144, dtype=float32), 'loss2': array(11.558727, dtype=float32), 'loss_tot': array(20.473871, dtype=float32), 'train_winning_ratio': 0.05907168602832903, 'epsilon': tensor([0.4569])}
{'loss': array(5.6662197, dtype=float32), 'loss2': array(12.064774, dtype=float32), 'loss_tot': array(17.730993, dtype=float32), 'train_winning_ratio': 0.031393115894581214, 'epsilon': tensor([0.4546])}
{'loss': array(6.4905357, dtype=float32), 'loss2': array(8.264511, dtype=float32), 'loss_tot': array(14.755047, dtype=float32), 'train_winning_ratio': 0.17058358890413217, 'epsilon': tensor([0.4523])}
{'loss': array(7.099621, dtype=float32), 'loss2': array(10.7751045, dtype=float32), 'loss_tot': array(17.874725, dtype=float32), 'train_winning_ratio': 0.19065511307080094, 'epsilon': tensor([0.4500])}
{'loss': array(8.391868, dtype=float32), 'loss2': array(8.260365, dtype=float32), 'loss_tot': array(16.652233, dtype=float32), 'train_winning_ratio': 0.10132194394545953, 'epsilon': tensor([0.4478])}
{'loss': array(10.024242, dtype=float32), 'loss2': array(14.518198, dtype=float32), 'loss_tot': array(24.54244, dtype=float32), 'train_winning_ratio': 0.11945663521231896, 'epsilon': tensor([0.4456])}
{'loss': array(7.9768844, dtype=float32), 'loss2': array(7.948251, dtype=float32), 'loss_tot': array(15.925135, dtype=float32), 'train_winning_ratio': 0.14448415367387002, 'epsilon': tensor([0.4433])}
{'loss': array(11.194712, dtype=float32), 'loss2': array(10.414037, dtype=float32), 'loss_tot': array(21.60875, dtype=float32), 'train_winning_ratio': 0.2396848031125952, 'epsilon': tensor([0.4411])}
{'loss': array(10.367896, dtype=float32), 'loss2': array(7.044514, dtype=float32), 'loss_tot': array(17.41241, dtype=float32), 'train_winning_ratio': 0.2083783314509607, 'epsilon': tensor([0.4389])}
{'loss': array(10.360584, dtype=float32), 'loss2': array(13.508856, dtype=float32), 'loss_tot': array(23.86944, dtype=float32), 'train_winning_ratio': 0.29174078884463006, 'epsilon': tensor([0.4367])}
{'loss': array(7.673198, dtype=float32), 'loss2': array(8.400734, dtype=float32), 'loss_tot': array(16.073933, dtype=float32), 'train_winning_ratio': 0.3089430165643791, 'epsilon': tensor([0.4345])}
{'loss': array(8.799367, dtype=float32), 'loss2': array(8.272223, dtype=float32), 'loss_tot': array(17.07159, dtype=float32), 'train_winning_ratio': 0.1641849856659902, 'epsilon': tensor([0.4324])}
{'loss': array(7.2623863, dtype=float32), 'loss2': array(9.663046, dtype=float32), 'loss_tot': array(16.925432, dtype=float32), 'train_winning_ratio': 0.22576463296731952, 'epsilon': tensor([0.4302])}
{'loss': array(12.107904, dtype=float32), 'loss2': array(9.963162, dtype=float32), 'loss_tot': array(22.071068, dtype=float32), 'train_winning_ratio': 0.11998058230878529, 'epsilon': tensor([0.4280])}
{'loss': array(8.868322, dtype=float32), 'loss2': array(5.489257, dtype=float32), 'loss_tot': array(14.357579, dtype=float32), 'train_winning_ratio': 0.20381160064276316, 'epsilon': tensor([0.4259])}
{'loss': array(7.974267, dtype=float32), 'loss2': array(9.6409855, dtype=float32), 'loss_tot': array(17.615253, dtype=float32), 'train_winning_ratio': 0.16736284085719075, 'epsilon': tensor([0.4238])}
{'loss': array(7.113949, dtype=float32), 'loss2': array(10.226429, dtype=float32), 'loss_tot': array(17.340378, dtype=float32), 'train_winning_ratio': 0.14799247550798636, 'epsilon': tensor([0.4217])}
{'loss': array(6.2043047, dtype=float32), 'loss2': array(5.5533123, dtype=float32), 'loss_tot': array(11.757617, dtype=float32), 'train_winning_ratio': 0.1515492691764398, 'epsilon': tensor([0.4195])}
{'loss': array(7.565583, dtype=float32), 'loss2': array(11.264615, dtype=float32), 'loss_tot': array(18.830198, dtype=float32), 'train_winning_ratio': 0.08053949516039635, 'epsilon': tensor([0.4174])}
{'loss': array(9.037539, dtype=float32), 'loss2': array(8.367424, dtype=float32), 'loss_tot': array(17.404963, dtype=float32), 'train_winning_ratio': 0.20185098984753622, 'epsilon': tensor([0.4154])}
{'loss': array(11.37217, dtype=float32), 'loss2': array(12.57569, dtype=float32), 'loss_tot': array(23.94786, dtype=float32), 'train_winning_ratio': 0.1882718918955645, 'epsilon': tensor([0.4133])}
{'loss': array(8.180031, dtype=float32), 'loss2': array(9.040743, dtype=float32), 'loss_tot': array(17.220774, dtype=float32), 'train_winning_ratio': 0.10005540250087072, 'epsilon': tensor([0.4112])}
{'loss': array(8.9650955, dtype=float32), 'loss2': array(11.393452, dtype=float32), 'loss_tot': array(20.358547, dtype=float32), 'train_winning_ratio': 0.05317354316046524, 'epsilon': tensor([0.4092])}
{'loss': array(7.4053345, dtype=float32), 'loss2': array(10.493023, dtype=float32), 'loss_tot': array(17.898357, dtype=float32), 'train_winning_ratio': 0.10925860095074082, 'epsilon': tensor([0.4071])}
{'loss': array(10.397922, dtype=float32), 'loss2': array(11.092665, dtype=float32), 'loss_tot': array(21.490585, dtype=float32), 'train_winning_ratio': 0.15806450014786266, 'epsilon': tensor([0.4051])}
{'loss': array(5.8091903, dtype=float32), 'loss2': array(6.7394195, dtype=float32), 'loss_tot': array(12.54861, dtype=float32), 'train_winning_ratio': 0.08400195602308029, 'epsilon': tensor([0.4031])}
{'loss': array(5.742388, dtype=float32), 'loss2': array(5.938263, dtype=float32), 'loss_tot': array(11.680651, dtype=float32), 'train_winning_ratio': 0.044642083510861824, 'epsilon': tensor([0.4010])}
{'loss': array(6.7692204, dtype=float32), 'loss2': array(12.379327, dtype=float32), 'loss_tot': array(19.148548, dtype=float32), 'train_winning_ratio': 0.12372463350309593, 'epsilon': tensor([0.3990])}
{'loss': array(10.132725, dtype=float32), 'loss2': array(14.737469, dtype=float32), 'loss_tot': array(24.870193, dtype=float32), 'train_winning_ratio': 0.06575234295351881, 'epsilon': tensor([0.3970])}
{'loss': array(9.159721, dtype=float32), 'loss2': array(4.109947, dtype=float32), 'loss_tot': array(13.269669, dtype=float32), 'train_winning_ratio': 0.034943490891561, 'epsilon': tensor([0.3951])}
{'loss': array(9.660283, dtype=float32), 'loss2': array(9.85177, dtype=float32), 'loss_tot': array(19.512054, dtype=float32), 'train_winning_ratio': 0.2814704037429021, 'epsilon': tensor([0.3931])}
{'loss': array(7.5745344, dtype=float32), 'loss2': array(6.1391525, dtype=float32), 'loss_tot': array(13.713687, dtype=float32), 'train_winning_ratio': 0.14958491283553166, 'epsilon': tensor([0.3911])}
{'loss': array(12.789965, dtype=float32), 'loss2': array(8.267595, dtype=float32), 'loss_tot': array(21.05756, dtype=float32), 'train_winning_ratio': 0.30954455566222777, 'epsilon': tensor([0.3892])}
{'loss': array(12.295631, dtype=float32), 'loss2': array(7.694882, dtype=float32), 'loss_tot': array(19.990513, dtype=float32), 'train_winning_ratio': 0.23740466820569, 'epsilon': tensor([0.3872])}
{'loss': array(7.1069603, dtype=float32), 'loss2': array(8.437861, dtype=float32), 'loss_tot': array(15.544822, dtype=float32), 'train_winning_ratio': 0.1261665742759001, 'epsilon': tensor([0.3853])}
{'loss': array(7.425094, dtype=float32), 'loss2': array(10.503107, dtype=float32), 'loss_tot': array(17.928202, dtype=float32), 'train_winning_ratio': 0.16705009039975866, 'epsilon': tensor([0.3833])}
{'loss': array(8.48835, dtype=float32), 'loss2': array(5.2335205, dtype=float32), 'loss_tot': array(13.72187, dtype=float32), 'train_winning_ratio': 0.08877726709213815, 'epsilon': tensor([0.3814])}
{'loss': array(6.5396237, dtype=float32), 'loss2': array(5.2390885, dtype=float32), 'loss_tot': array(11.778712, dtype=float32), 'train_winning_ratio': 0.12007987960071301, 'epsilon': tensor([0.3795])}
{'loss': array(9.765982, dtype=float32), 'loss2': array(6.5655556, dtype=float32), 'loss_tot': array(16.331537, dtype=float32), 'train_winning_ratio': 0.06381537129488253, 'epsilon': tensor([0.3776])}
{'loss': array(6.1143255, dtype=float32), 'loss2': array(8.818532, dtype=float32), 'loss_tot': array(14.9328575, dtype=float32), 'train_winning_ratio': 0.1149141047363237, 'epsilon': tensor([0.3757])}
{'loss': array(7.9009137, dtype=float32), 'loss2': array(10.546636, dtype=float32), 'loss_tot': array(18.44755, dtype=float32), 'train_winning_ratio': 0.06107006673517661, 'epsilon': tensor([0.3739])}
{'loss': array(6.000058, dtype=float32), 'loss2': array(5.8950214, dtype=float32), 'loss_tot': array(11.89508, dtype=float32), 'train_winning_ratio': 0.122455137335809, 'epsilon': tensor([0.3720])}
{'loss': array(6.299595, dtype=float32), 'loss2': array(16.287447, dtype=float32), 'loss_tot': array(22.587042, dtype=float32), 'train_winning_ratio': 0.1379776806408797, 'epsilon': tensor([0.3701])}
{'loss': array(6.877316, dtype=float32), 'loss2': array(6.8117604, dtype=float32), 'loss_tot': array(13.689076, dtype=float32), 'train_winning_ratio': 0.15432699657746976, 'epsilon': tensor([0.3683])}
{'loss': array(6.811627, dtype=float32), 'loss2': array(5.273372, dtype=float32), 'loss_tot': array(12.084999, dtype=float32), 'train_winning_ratio': 0.15491569338812716, 'epsilon': tensor([0.3664])}
{'loss': array(5.6060925, dtype=float32), 'loss2': array(4.530091, dtype=float32), 'loss_tot': array(10.136183, dtype=float32), 'train_winning_ratio': 0.1723285510098797, 'epsilon': tensor([0.3646])}
{'loss': array(5.8815823, dtype=float32), 'loss2': array(4.3163514, dtype=float32), 'loss_tot': array(10.197933, dtype=float32), 'train_winning_ratio': 0.26448245747724153, 'epsilon': tensor([0.3628])}
{'loss': array(7.5944233, dtype=float32), 'loss2': array(5.092347, dtype=float32), 'loss_tot': array(12.68677, dtype=float32), 'train_winning_ratio': 0.23055682168416275, 'epsilon': tensor([0.3610])}
{'loss': array(6.3517017, dtype=float32), 'loss2': array(5.8887424, dtype=float32), 'loss_tot': array(12.240444, dtype=float32), 'train_winning_ratio': 0.18157634787265317, 'epsilon': tensor([0.3592])}
INFO:sc2.protocol:Client status changed to Status.launched (was Status.in_game)
INFO:sc2.protocol:Client status changed to Status.quit (was Status.launched)
INFO:sc2.sc2process:Closing connection...
INFO:sc2.sc2process:Cleaning up...
INFO:sc2.sc2process:Cleanup complete
Exception in thread Thread-75:
Traceback (most recent call last):
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\threading.py", line 926, in _bootstrap_inner
    self.run()
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\runners\RunnerBase.py", line 22, in run_n_episodes
    trajectory = self.run_1_episode()
  File "C:\Users\joon0\dev\hierarchical_qmix\src\runners\MultiStepActorRunner.py", line 39, in run_1_episode
    next_state_dict, reward, done = self.env.step(sc2_action)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\environments\MicroTestEnvironment.py", line 111, in step
    _ = self.reset()
  File "C:\Users\joon0\dev\hierarchical_qmix\src\environments\MicroTestEnvironment.py", line 63, in reset
    sc2_game_state = self._reset()
  File "C:\Users\joon0\dev\hierarchical_qmix\src\environments\EnvironmentBase.py", line 126, in _reset
    allies_info = self._loop_run(self.run_game())
  File "C:\Users\joon0\dev\hierarchical_qmix\src\environments\EnvironmentBase.py", line 118, in _loop_run
    return self.loop.run_until_complete(coroutine)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\asyncio\base_events.py", line 579, in run_until_complete
    return future.result()
  File "C:\Users\joon0\dev\hierarchical_qmix\src\environments\EnvironmentBase.py", line 102, in run_game
    result = await self._host_game()
  File "C:\Users\joon0\dev\hierarchical_qmix\src\environments\EnvironmentBase.py", line 82, in _host_game
    async with NotCloseSC2Process() as server:
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\sc2\sc2process.py", line 58, in __aenter__
    signal.signal(signal.SIGINT, signal_handler)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\signal.py", line 47, in signal
    handler = _signal.signal(_enum_to_int(signalnum), _enum_to_int(handler))
ValueError: signal only works in main thread

{'loss': array(5.387744, dtype=float32), 'loss2': array(5.118244, dtype=float32), 'loss_tot': array(10.505988, dtype=float32), 'train_winning_ratio': 0.3223691575991642, 'epsilon': tensor([0.3574])}
WARNING:aiohttp.websocket:websocket connection is closing.
WARNING:aiohttp.websocket:websocket connection is closing.
INFO:sc2.sc2process:Closing connection...
INFO:sc2.sc2process:Cleaning up...
INFO:sc2.sc2process:Cleanup complete
INFO:sc2.protocol:Client status changed to Status.launched (was None)
INFO:sc2.controller:Creating new game
INFO:sc2.controller:Map:     training_scenario_5
