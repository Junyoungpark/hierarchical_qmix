Python 3.7.4 (default, Aug  9 2019, 18:34:13) [MSC v.1915 64 bit (AMD64)]
Type 'copyright', 'credits' or 'license' for more information
IPython 7.9.0 -- An enhanced Interactive Python. Type '?' for help.
PyDev console: using IPython 7.9.0

Out[1]: 
tensor([[0.0000, 0.0000, 1.0000,  ..., 6.9699, 1.0000, 0.0000],
        [0.0000, 0.0000, 1.0000,  ..., 6.9699, 1.0000, 0.0000],
        [0.0000, 0.0000, 1.0000,  ..., 6.9699, 1.0000, 0.0000],
        ...,
        [0.0000, 0.0000, 1.0000,  ..., 6.9699, 1.0000, 0.0000],
        [0.0000, 0.0000, 1.0000,  ..., 6.9699, 1.0000, 0.0000],
        [0.0000, 0.0000, 1.0000,  ..., 6.9699, 1.0000, 0.0000]])
Out[2]: torch.Size([30, 38])
Out[3]: 38
Out[5]: 
tensor([[-2.6389e-05,  1.4398e+00,  2.5684e+01, -3.3366e-06,  2.1311e+01,
          1.3594e+01, -1.2976e-12,  8.7124e+00],
        [-2.8918e-05,  2.2570e+00,  2.6122e+01, -7.8453e-06,  2.1351e+01,
          1.3360e+01, -1.9898e-12,  9.3828e+00],
        [-1.9231e-05,  5.5219e-01,  2.4742e+01, -1.1464e-06,  2.0706e+01,
          1.2229e+01, -1.9878e-12,  7.0860e+00],
        [-3.9533e-05,  1.4462e+00,  2.4759e+01, -4.1779e-06,  1.9944e+01,
          1.1763e+01, -6.0616e-12,  7.1961e+00],
        [-4.5578e-05,  1.6888e+00,  2.5331e+01, -6.0026e-06,  2.0600e+01,
          1.3081e+01, -3.3802e-12,  8.2568e+00],
        [-1.8129e-05,  4.1818e-01,  2.4886e+01, -1.0474e-06,  2.1012e+01,
          1.2551e+01, -1.5916e-12,  7.2616e+00],
        [-1.6378e-05,  1.5407e+00,  2.6199e+01, -3.3643e-06,  2.2057e+01,
          1.3629e+01, -9.4005e-13,  9.2865e+00],
        [-2.7361e-05,  1.0565e+00,  2.4955e+01, -2.2441e-06,  2.0537e+01,
          1.2483e+01, -2.4640e-12,  7.5151e+00],
        [-1.9833e-05,  9.1137e-01,  2.5637e+01, -2.0328e-06,  2.1692e+01,
          1.3643e+01, -9.8859e-13,  8.4863e+00],
        [-2.0577e-05,  1.4691e+00,  2.5931e+01, -3.3086e-06,  2.1699e+01,
          1.3615e+01, -1.0898e-12,  8.9969e+00],
        [-2.6389e-05,  1.4398e+00,  2.5684e+01, -3.3366e-06,  2.1311e+01,
          1.3594e+01, -1.2976e-12,  8.7124e+00],
        [-2.8918e-05,  2.2570e+00,  2.6122e+01, -7.8453e-06,  2.1351e+01,
          1.3360e+01, -1.9898e-12,  9.3828e+00],
        [-1.9231e-05,  5.5219e-01,  2.4742e+01, -1.1464e-06,  2.0706e+01,
          1.2229e+01, -1.9878e-12,  7.0860e+00],
        [-3.9533e-05,  1.4462e+00,  2.4759e+01, -4.1779e-06,  1.9944e+01,
          1.1763e+01, -6.0617e-12,  7.1961e+00],
        [-4.5578e-05,  1.6888e+00,  2.5331e+01, -6.0025e-06,  2.0600e+01,
          1.3081e+01, -3.3802e-12,  8.2568e+00],
        [-1.8129e-05,  4.1818e-01,  2.4886e+01, -1.0474e-06,  2.1012e+01,
          1.2551e+01, -1.5915e-12,  7.2616e+00],
        [-1.6377e-05,  1.5407e+00,  2.6199e+01, -3.3643e-06,  2.2057e+01,
          1.3629e+01, -9.4005e-13,  9.2865e+00],
        [-2.7361e-05,  1.0565e+00,  2.4955e+01, -2.2441e-06,  2.0537e+01,
          1.2483e+01, -2.4640e-12,  7.5151e+00],
        [-1.9833e-05,  9.1137e-01,  2.5637e+01, -2.0329e-06,  2.1692e+01,
          1.3643e+01, -9.8859e-13,  8.4863e+00],
        [-2.0577e-05,  1.4691e+00,  2.5931e+01, -3.3086e-06,  2.1699e+01,
          1.3615e+01, -1.0898e-12,  8.9969e+00],
        [-2.6389e-05,  1.4398e+00,  2.5684e+01, -3.3366e-06,  2.1311e+01,
          1.3594e+01, -1.2976e-12,  8.7124e+00],
        [-2.8918e-05,  2.2570e+00,  2.6122e+01, -7.8453e-06,  2.1351e+01,
          1.3360e+01, -1.9898e-12,  9.3828e+00],
        [-1.9231e-05,  5.5219e-01,  2.4742e+01, -1.1464e-06,  2.0706e+01,
          1.2229e+01, -1.9878e-12,  7.0860e+00],
        [-3.9532e-05,  1.4462e+00,  2.4759e+01, -4.1779e-06,  1.9944e+01,
          1.1763e+01, -6.0616e-12,  7.1961e+00],
        [-4.5578e-05,  1.6888e+00,  2.5331e+01, -6.0025e-06,  2.0600e+01,
          1.3081e+01, -3.3802e-12,  8.2568e+00],
        [-1.8129e-05,  4.1818e-01,  2.4886e+01, -1.0474e-06,  2.1012e+01,
          1.2551e+01, -1.5916e-12,  7.2616e+00],
        [-1.6377e-05,  1.5407e+00,  2.6199e+01, -3.3643e-06,  2.2057e+01,
          1.3629e+01, -9.4005e-13,  9.2865e+00],
        [-2.7361e-05,  1.0565e+00,  2.4955e+01, -2.2441e-06,  2.0537e+01,
          1.2483e+01, -2.4640e-12,  7.5151e+00],
        [-1.9833e-05,  9.1137e-01,  2.5637e+01, -2.0328e-06,  2.1692e+01,
          1.3643e+01, -9.8859e-13,  8.4863e+00],
        [-2.0577e-05,  1.4691e+00,  2.5931e+01, -3.3086e-06,  2.1699e+01,
          1.3615e+01, -1.0898e-12,  8.9969e+00]], grad_fn=<MulBackward0>)
Out[6]: torch.Size([30, 8])
Exception in thread Thread-14:
Traceback (most recent call last):
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\threading.py", line 926, in _bootstrap_inner
    self.run()
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\threading.py", line 870, in run
    self._target(*self._args, **self._kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\runners\RunnerBase.py", line 22, in run_n_episodes
    trajectory = self.run_1_episode()
  File "C:\Users\joon0\dev\hierarchical_qmix\src\runners\MultiStepActorRunner.py", line 37, in run_1_episode
    tag2unit_dict=tag2unit_dict)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\agent\QmixAgent.py", line 81, in get_action
    maximum_num_enemy=maximum_num_enemy)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\brain\QmixBrain.py", line 86, in get_action
    nn_actions, info_dict = qnet.get_action(**inputs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\rl\MultiStepQnet.py", line 64, in get_action
    curr_graph, curr_feature, maximum_num_enemy)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\rl\MultiStepQnet.py", line 48, in compute_qs
    curr_feature)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\torch\nn\modules\module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\MultiStepInputGraphNetwork.py", line 61, in forward
    h_enc_out, h_enc_hidden = self.hist_encoder(num_time_steps, hist_graph, hist_feature)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\torch\nn\modules\module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\RNNEncoder.py", line 31, in forward
    embedded_feature_dict = self.one_step_encoder(batch_time_batched_graph, node_feat)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\torch\nn\modules\module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\RelationalGraphNetwork.py", line 66, in forward
    node_feature = layer(graph, node_feature)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\torch\nn\modules\module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\RelationalGraphLayer.py", line 99, in forward
    reduce_func=self.reduce_function)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\dgl\graph.py", line 2502, in send_and_recv
    Runtime.run(prog)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\dgl\runtime\runtime.py", line 11, in run
    exe.run()
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\dgl\runtime\ir\executor.py", line 132, in run
    udf_ret = fn_data(node_data, mail_data)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\dgl\runtime\degree_bucketing.py", line 153, in _rfunc_wrapper
    return reduce_udf(nbatch)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\nn\RelationalGraphLayer.py", line 146, in reduce_function
    node_enc_input[:, :self.input_dim + self.init_dim] = F.relu(node_feature)
RuntimeError: The expanded size of the tensor (16) must match the existing size (27) at non-singleton dimension 1.  Target sizes: [30, 16].  Tensor sizes: [30, 27]

Traceback (most recent call last):
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\pydevd.py", line 2073, in <module>
    main()
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\pydevd.py", line 2067, in main
    globals = debugger.run(setup['file'], None, None, is_module)
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\pydevd.py", line 1418, in run
    return self._exec(is_module, entry_point_fn, module_name, file, globals, locals)
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\pydevd.py", line 1425, in _exec
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "C:\Program Files\JetBrains\PyCharm 2019.1.1\helpers\pydev\_pydev_imps\_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "C:/Users/joon0/dev/hierarchical_qmix/src/test/test.py", line 34, in <module>
    fit_return_dict = agent.fit(device='cuda')
  File "C:\Users\joon0\dev\hierarchical_qmix\src\agent\QmixAgent.py", line 124, in fit
    c_h_graph, c_graph, actions, rewards, n_h_graph, n_graph, dones = self.buffer.sample(batch_size)
  File "C:\Users\joon0\dev\hierarchical_qmix\src\memory\MemoryBase.py", line 55, in sample
    effective_num_samples = np.cumsum(num_samples_par_trajs)[-1]
IndexError: index -1 is out of bounds for axis 0 with size 0
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\IPython\core\history.py", line 780, in writeout_cache
    self._writeout_input_cache(conn)
  File "C:\Users\joon0\Anaconda3\envs\gpu_torch130\lib\site-packages\IPython\core\history.py", line 764, in _writeout_input_cache
    (self.session_number,)+line)
sqlite3.ProgrammingError: SQLite objects created in a thread can only be used in that same thread. The object was created in thread id 22748 and this is thread id 16168.
[0m